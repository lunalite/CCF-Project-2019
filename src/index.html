<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="./style/style.css">
  <title>CCF Attendance</title>
  <script type="text/javascript" src="./js/constants.js"></script>
</head>
<body>
<div class="sidenav">
  <a href="index.html">Dashboard</a>
  <a href="attendance.html">Take Attendance</a>
  <a href="manage.html">Manage Students</a>
</div>
<div class="main">
  <div id="student-display"></div>
</div>

<script>
    function updateStudentDisplay() {
        // send call to backend and get result
        let oReq = new XMLHttpRequest();
        let userReq = new XMLHttpRequest();

        oReq.open("GET", `${basePath}${attendancePath}`);
        oReq.onload = function () {
            const responseJson = JSON.parse(this.response);
            let template = '';
            template += '<table>';
            template += '<tr>';
            template += '<th>ID</th>';
            template += '<th align="left">Name</th>';
            for (const item of responseJson) {
                template += `<th>${item['class_name']}</th>`;
            }
            template += '</tr>';
            for (const item of responseJson) {
                userReq.open('GET', `${basePath}${studentPath}${item['student_id']}`, true);
                userReq.onload = function () {
                    console.log(this.response["ID"])
                    console.log(this.response.ID)
                    console.log(this.response)
                    template += '<tr>';
                    template += `<td>${item['student_id']}</td>`;
                    template += `<td>${this.response.name}</td>`;
                    template += `<td>${item['attended']}</td>`;
                    template += '</tr>';
                };
                userReq.send();
            }
            template += '</table>';
            document.getElementById("student-display").innerHTML = template
        };

        oReq.send();
    }

    updateStudentDisplay()
</script>
</body>
</html>
